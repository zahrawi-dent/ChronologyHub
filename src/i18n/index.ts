import { translator, flatten, resolveTemplate } from "@solid-primitives/i18n";
import { createSignal } from "solid-js";

export type Locale = "en" | "ar";

export const [currentLocale, setCurrentLocale] = createSignal<Locale>("en");

export const changeLocale = (newLocale: Locale) => {
  setCurrentLocale(newLocale);
};

export const isRTL = () => currentLocale() === "ar";

// Translation dictionaries
const enDict = {
  common: {
    chart: "Chart",
    timeline: "Interactive Timeline",
    table: "Reference Table",
    study: "Study Mode",
  },
  hero: {
    title: "Chronology Hub",
    interactiveTimeline: "Interactive Timeline",
    interactiveTimelineDesc: "Step through dental development milestones with visual feedback",
    comprehensiveData: "Comprehensive Data",
    comprehensiveDataDesc: "Detailed information on eruption ages, shedding, and development",
    studyMode: "Study Mode",
    studyModeDesc: "Test your knowledge with interactive quizzes and challenges",
  },
  footer: {
    projectBy: "A project by",
    builtInEgypt: "Built in Egypt with ❤️ for the dental community.",
    license: "AGPLv3 License",
  },
  language: {
    english: "English",
    arabic: "العربية",
  },
  // Tooth names
  teeth: {
    centralIncisor: "Central Incisor",
    lateralIncisor: "Lateral Incisor",
    canine: "Canine",
    firstPremolar: "First Premolar",
    secondPremolar: "Second Premolar",
    firstMolar: "First Molar",
    secondMolar: "Second Molar",
    thirdMolar: "Third Molar (Wisdom)",
  },
  // Timeline component
  timeline: {
    title: "Dental Development Timeline",
    subtitle: "Step through the chronological development of teeth from birth to adulthood",
    progress: "Progress",
    reset: "Reset",
    previous: "Previous",
    next: "Next",
    end: "End",
    birth: "Birth",
    noTeethPresent: "No teeth present yet",
    developmentComplete: "Development Complete! All teeth have erupted.",
    noNewEruptions: "No new eruptions at this stage",
    mixedDentitionStage: "Mixed Dentition Stage",
    currentDentalState: "Current Dental State",
    toothDetails: "Tooth Details",
    noToothSelected: "No tooth selected",
    clickToothDetails: "Click on a tooth in the chart to see its details",
    timelineSteps: "Timeline Steps",
    step: "Step",
    primary: "Primary",
    permanent: "Permanent",
    eruption: "erupts",
    shedding: "sheds",
    teethErupt: "teeth erupt",
    arrowKeysNavigate: "← → Arrow keys to navigate",
    homeEndJump: "Home/End to jump",
  },
  // Study Mode component
  studyMode: {
    title: "Study Mode",
    stats: "Stats",
    newSession: "New Session",
    studyStatistics: "Study Statistics",
    bestScore: "Best Score",
    sessions: "Sessions",
    questions: "Questions",
    recentSessions: "Recent Sessions",
    studyConfiguration: "Study Configuration",
    studyFocus: "Study Focus",
    eruptionAges: "Eruption Ages",
    eruptionAgesDesc: "Learn when teeth appear and fall out",
    toothNotation: "Tooth Notation",
    toothNotationDesc: "Master numbering systems",
    mixedReview: "Mixed Review",
    mixedReviewDesc: "Comprehensive knowledge test",
    studySessionComplete: "Study Session Complete!",
    youGotCorrect: "You got {correct} out of {total} correct",
    startNewSession: "Start New Session",
    viewStats: "View Stats",
    cardOf: "Card {current} of {total}",
    correct: "correct",
    primary: "Primary",
    permanent: "Permanent",
    upper: "Upper",
    lower: "Lower",
    whenDoesToothErupt: "When does this tooth typically erupt?",
    alsoWhenDoesShed: "Also, when does it typically shed?",
    whatAreNotationNumbers: "What are the notation numbers for this tooth?",
    universalPalmerFdi: "Universal, Palmer, and FDI systems",
    whatDoYouKnow: "What do you know about this tooth?",
    eruptionNotationCharacteristics: "Eruption age, notation, and characteristics",
    eruptionTimeline: "Eruption Timeline",
    eruptionAge: "Eruption Age",
    average: "Average:",
    sheddingAge: "Shedding Age",
    rootCompletion: "Root Completion",
    notationSystems: "Notation Systems",
    universal: "Universal",
    palmer: "Palmer",
    fdi: "FDI",
    previous: "Previous",
    nextCard: "Next Card",
    dontKnow: "Don't Know",
    skip: "Skip",
    iKnowThis: "I Know This!",
    months: "months",
    years: "years",
    y: "y",
    m: "m",
  },
  // Reference Table component
  referenceTable: {
    title: "Dental Reference Table",
    subtitle: "Comprehensive tooth eruption and development timeline",
    searchTeeth: "Search Teeth",
    searchPlaceholder: "Try search: 'max cen', 'pri mol sec', ...",
    toothType: "Tooth Type",
    allTeeth: "All Teeth",
    primary: "Primary",
    permanent: "Permanent",
    showingOfTeeth: "Showing {shown} of {total} teeth",
    only: "only",
    toothName: "Tooth Name",
    crownCompletion: "Crown Completion",
    eruptionAge: "Eruption Age",
    sheddingAge: "Shedding Age",
    rootCompletion: "Root Completion",
    na: "N/A",
    noTeethFound: "No teeth found",
    tryAdjustingSearch: "Try adjusting your search terms or filters",
  },
  // Common terms
  commonTerms: {
    left: "left",
    right: "right",
    maxillary: "maxillary",
    mandibular: "mandibular",
  },
};

const arDict = {
  common: {
    chart: "الرسم البياني",
    timeline: "الجدول الزمني التفاعلي",
    table: "جدول المرجع",
    study: "وضع الدراسة",
  },
  hero: {
    title: "مركز التسلسل الزمني",
    interactiveTimeline: "الجدول الزمني التفاعلي",
    interactiveTimelineDesc: "مرر عبر مراحل تطور الأسنان مع تغذية راجعة بصرية",
    comprehensiveData: "البيانات الشاملة",
    comprehensiveDataDesc: "معلومات مفصلة حول أعمار الإنبثاق والتساقط والتطور",
    studyMode: "وضع الدراسة",
    studyModeDesc: "اختبر معرفتك مع الاختبارات والتحديات التفاعلية",
  },
  footer: {
    projectBy: "مشروع من",
    builtInEgypt: "بني في مصر بـ❤️ للمجتمع الطبي.",
    license: "رخصة AGPLv3",
  },
  language: {
    english: "English",
    arabic: "العربية",
  },
  // Tooth names
  teeth: {
    centralIncisor: "القاطع المركزي",
    lateralIncisor: "القاطع الجانبي",
    canine: "الناب",
    firstPremolar: "الضاحك الأول",
    secondPremolar: "الضاحك الثاني",
    firstMolar: "الطاحن الأول",
    secondMolar: "الطاحن الثاني",
    thirdMolar: "الطاحن الثالث (الضرس العقل)",
  },
  // Timeline component
  timeline: {
    title: "جدول تطور الأسنان الزمني",
    subtitle: "مرر عبر التطور الزمني للأسنان من الولادة إلى البلوغ",
    progress: "التقدم",
    reset: "إعادة تعيين",
    previous: "السابق",
    next: "التالي",
    end: "النهاية",
    birth: "الولادة",
    noTeethPresent: "لا توجد أسنان بعد",
    developmentComplete: "اكتمل التطور! انبثقت جميع الأسنان.",
    noNewEruptions: "لا توجد انبثاقات جديدة في هذه المرحلة",
    mixedDentitionStage: "مرحلة الخلطة السنية",
    currentDentalState: "الحالة السنية الحالية",
    toothDetails: "تفاصيل السن",
    noToothSelected: "لم يتم اختيار سن",
    clickToothDetails: "انقر على سن في الرسم البياني لرؤية التفاصيل",
    timelineSteps: "خطوات الجدول الزمني",
    step: "خطوة",
    primary: "أولي",
    permanent: "دائم",
    eruption: "تنبثق",
    shedding: "تتساقط",
    teethErupt: "أسنان تنبثق",
    arrowKeysNavigate: "← → مفاتيح الأسهم للتنقل",
    homeEndJump: "Home/End للقفز",
  },
  // Study Mode component
  studyMode: {
    title: "وضع الدراسة",
    stats: "الإحصائيات",
    newSession: "جلسة جديدة",
    studyStatistics: "إحصائيات الدراسة",
    bestScore: "أفضل نتيجة",
    sessions: "الجلسات",
    questions: "الأسئلة",
    recentSessions: "الجلسات الأخيرة",
    studyConfiguration: "إعدادات الدراسة",
    studyFocus: "تركيز الدراسة",
    eruptionAges: "أعمار الإنبثاق",
    eruptionAgesDesc: "تعلم متى تظهر الأسنان وتتساقط",
    toothNotation: "تدوين الأسنان",
    toothNotationDesc: "إتقان أنظمة الترقيم",
    mixedReview: "مراجعة مختلطة",
    mixedReviewDesc: "اختبار معرفة شامل",
    studySessionComplete: "اكتملت جلسة الدراسة!",
    youGotCorrect: "حصلت على {correct} من {total} صحيح",
    startNewSession: "ابدأ جلسة جديدة",
    viewStats: "عرض الإحصائيات",
    cardOf: "البطاقة {current} من {total}",
    correct: "صحيح",
    primary: "أولي",
    permanent: "دائم",
    upper: "علوي",
    lower: "سفلي",
    whenDoesToothErupt: "متى ينبثق هذا السن عادة؟",
    alsoWhenDoesShed: "أيضاً، متى يتساقط عادة؟",
    whatAreNotationNumbers: "ما هي أرقام التدوين لهذا السن؟",
    universalPalmerFdi: "أنظمة الترقيم العالمي والبالمر والفدي",
    whatDoYouKnow: "ماذا تعرف عن هذا السن؟",
    eruptionNotationCharacteristics: "عمر الإنبثاق والتدوين والخصائص",
    eruptionTimeline: "جدول الإنبثاق الزمني",
    eruptionAge: "عمر الإنبثاق",
    average: "متوسط:",
    sheddingAge: "عمر التساقط",
    rootCompletion: "إكمال الجذر",
    notationSystems: "أنظمة التدوين",
    universal: "عالمي",
    palmer: "بالمر",
    fdi: "فدي",
    previous: "السابق",
    nextCard: "البطاقة التالية",
    dontKnow: "لا أعرف",
    skip: "تخطي",
    iKnowThis: "أعرف هذا!",
    months: "أشهر",
    years: "سنوات",
    y: "س",
    m: "ش",
  },
  // Reference Table component
  referenceTable: {
    title: "جدول مرجع الأسنان",
    subtitle: "جدول زمني شامل لإنبثاق وتطور الأسنان",
    searchTeeth: "البحث في الأسنان",
    searchPlaceholder: "جرب البحث: 'max cen', 'pri mol sec', ...",
    toothType: "نوع السن",
    allTeeth: "جميع الأسنان",
    primary: "أولي",
    permanent: "دائم",
    showingOfTeeth: "عرض {shown} من {total} أسنان",
    only: "فقط",
    toothName: "اسم السن",
    crownCompletion: "إكمال التاج",
    eruptionAge: "عمر الإنبثاق",
    sheddingAge: "عمر التساقط",
    rootCompletion: "إكمال الجذر",
    na: "غير متوفر",
    noTeethFound: "لم يتم العثور على أسنان",
    tryAdjustingSearch: "جرب تعديل مصطلحات البحث أو المرشحات",
  },
  // Common terms
  commonTerms: {
    left: "يسار",
    right: "يمين",
    maxillary: "فك علوي",
    mandibular: "فك سفلي",
  },
};

// Create flattened dictionaries
const flattenedEnDict = flatten(enDict);
const flattenedArDict = flatten(arDict);

// Create translator function
const getDict = () => (currentLocale() === "en" ? flattenedEnDict : flattenedArDict);

export const t = translator(getDict, resolveTemplate);

// Helper function to get translated tooth name
export const getToothName = (nameKey: string) => t(`teeth.${nameKey}` as any);